<%# locals: form %>
<%= render partial: "shared/authentication/email_address", locals: { form: form } %>

<div class="form-group">
  <% if @user.org.shibbolized? %>
    <%= render partial: "shared/authentication/shib_sign_in", locals: { form: form } %>

  <% else %>
    <%# Display the standard Sign up form %>
    <%= form.label(:firstname, _('First Name'), class: "control-label") %>
    <%= form.text_field(:firstname, class: "form-control", "aria-required": true) %>

    <%= form.label(:surname, _('Last Name'), class: "control-label") %>
    <%= form.text_field(:surname, class: "form-control", "aria-required": true) %>

    <div id="create-account-org-controls">
      <%= render partial: "shared/org_autocomplete",
                 locals: { form: form,
                           default_org: @user&.org,
                           required: true,
                           label: _("Institution") } %>
    </div>

    <%= form.label(:password, _('Password'), class: "control-label") %>
    <%= form.password_field(:password, class: "form-control", "aria-required": true) %>
    <%= form.label(:password_toggle) do %>
      <%= check_box_tag("passwords_toggle_sign_up", class: "passwords_toggle") %>
      <%= _('Show password') %>
    <% end %>

    <%= form.label(:accept_terms) do %>
      <%= form.check_box(:accept_terms, "aria-required": true) %>
      <%= _('I accept the') %>
      <%= link_to _('terms and conditions'), terms_path %>
    <% end %>

    <%= form.submit _("Sign up"), class: "btn btn-default" %>
  <% end %>
</div>
<p>
  <%= sanitize(_("This will create a new account. If you already have an account, %{go_back_link} to try a different email address, or %{contact_us_link}.") % {
    go_back_link: link_to(_("go back"), root_path),
    contact_us_link: link_to(_("contact us"), contact_us_path)
  }) %>
</p>

