<%
def margin_mm_to_px(val)
  crosswalk = {
    '5': '19px',
    '6': '23px',
    '7': '26px',
    '8': '30px',
    '9': '34px',
    '10': '38px',
    '11': '42px',
    '12': '45px',
    '13': '49px',
    '14': '53px',
    '15': '57px',
    '16': '60px',
    '17': '64px',
    '18': '68px',
    '19': '72px',
    '20': '76px',
    '21': '79px',
    '22': '83px',
    '23': '87px',
    '24': '91px',
    '25': '96px'
  }
  return crosswalk[val.to_s.to_sym] || crosswalk[:'25']
end

case font_size
when '8pt'
  converted_size = '10pt'
when '9pt'
  converted_size = '11pt'
when '10pt'
  converted_size = '12pt'
when '11pt'
  converted_size = '14pt'
when '12pt'
  converted_size = '15pt'
when '13pt'
  converted_size = '16pt'
when '14pt'
  converted_size = '18pt'
else
  converted_size = '14pt'
end

font_family = 'Tinos, serif'
font_family = 'Roboto, sans-serif' if font_face.downcase.include?('roboto')
font_family = 'Lora, serif' if font_face.downcase.include?('lora')
font_family = 'Merriweather, serif' if font_face.downcase.include?('merri')
font_family = 'Vollkorn, serif' if font_face.downcase.include?('vollk')
%>

<style>
  @page {
    margin-top: <%= margin_mm_to_px(margin_top) %>;
    margin-right: <%= margin_mm_to_px(margin_right) %>;
    margin-bottom: <%= margin_mm_to_px(margin_bottom) %>;
    margin-left: <%= margin_mm_to_px(margin_left) %>;
  }
  body {
    font-family: <%= font_family %>;
    font-size: <%= converted_size %>;
    line-height: 150%;
  }

  .break-after {
    page-break-after: always;
  }
  .break-before {
    page-break-before: always;
  }

  h1 {
    font-size: 1.2em;
  }
  h2 {
    font-size: 1.2em;
  }

  div.cover-page p {
    margin-left: 10px;
    margin-bottom: 35px;
  }

  div.section {
    margin-bottom: 35px;
  }
  div.question {
    margin-bottom: 25px;
  }
  div.question h3 {
    font-size: 1.1em;
    font-weight: bold;
  }

  table, tr, td, th, tbody, thead, tfoot {
    page-break-inside: avoid !important;
  }
  table {
    border-collapse: collapse;
  }
  table caption {
    font-weight: bold;
    font-size: 1.1em;
    text-align: left;
  }
  th, td {
    border: 1px solid black !important;
    padding: 2px;
  }

  .annotations {
    margin-left: 15px;
    margin-bottom: 10px;
  }

  ul.research_output {
    margin-bottom: 15px;
  }
  ul.research_output li {
    margin-bottom: 5px;
  }
  ul.research_output li strong {
    padding-right: 5px;
  }
</style>