<% presenter = ResearchOutputPresenter.new(research_output: @research_output) %>

var outputTypeForm = $('.research-output-form');

if (outputTypeForm.length > 0) {
  <%# Hide or Display the Description text field based on the Output Type selected %>
  var outputTypeSpans = outputTypeForm.find('.output-type-description');
  var outputTypeDescription = outputTypeForm.find('#research_output_output_type_description');

  <% if @research_output.other? %>
    outputTypeSpans.removeClass('hidden');
    outputTypeDescription.attr('aria-required', 'true');
  <% else %>
    outputTypeDescription.attr('aria-required', 'false');
    outputTypeSpans.addClass('hidden');
    var selected = outputTypeSpans.parent().find('option:selected');
    selected.removeAttr("selected");
  <% end %>

  <%# Hide or Display the Mime Type select box and Byte Size based on the Output Type selected %>
  var fileMetadataPanel = outputTypeForm.find('#file-metadata-panel');

  <% if presenter.selectable_mime_types.any? %>
    fileMetadataPanel.removeClass('hidden');
    var selector = fileMetadataPanel.find('#research_output_mime_type_id');
    selector.html('<%= escape_javascript(render(partial: "research_outputs/mime_types", locals: { mime_types: presenter.selectable_mime_types })) %>');
  <% else %>
    fileMetadataPanel.addClass('hidden');
    var selected = fileMetadataPanel.find('option:selected');
    selected.removeAttr("selected");
    var sizeField = fileMetadataPanel.find('#research_output_file_size');
    sizeField.val("");
  <% end %>
}
