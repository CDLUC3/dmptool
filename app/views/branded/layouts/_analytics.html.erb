<% if Rails.env.stage? && Rails.configuration.x.dmproadmap.usersnap_key.present? %>
  <script type="text/javascript">
    window.onUsersnapCXLoad = function(api) {
      api.init();
    }
    var script = document.createElement('script');
    script.defer = 1;
    script.src = 'https://widget.usersnap.com/global/load/<%= Rails.configuration.x.dmproadmap.usersnap_key %>?onload=onUsersnapCXLoad';
    document.getElementsByTagName('head')[0].appendChild(script);
  </script>
<% end %>

<% if Rails.env.production? && Rails.configuration.x.dmproadmap.enable_matomo %>
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//matomo.cdlib.org/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '20']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
<% end %>
